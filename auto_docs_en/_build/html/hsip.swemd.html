

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Empirical mode decomposition (EMD) &mdash; HSI Processing 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Color image synthesis" href="hsip.rgb.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            HSI Processing
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="hsip.analysis.html">Signature analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsip.clustering.html">Clustering of hyperspectral data</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsip.processing.html">Methods of processing hyperspectral data</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsip.reader.html">Hyperspectral data reading tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="hsip.rgb.html">Color image synthesis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Empirical mode decomposition (EMD)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-hsip.swemd.swemd">Methods for decomposition into EMD</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hsip.swemd.swemd.SWEMD"><code class="docutils literal notranslate"><span class="pre">SWEMD()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#hsip.swemd.swemd.SWEMD_signal"><code class="docutils literal notranslate"><span class="pre">SWEMD_signal()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">HSI Processing</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Empirical mode decomposition (EMD)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/hsip.swemd.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="empirical-mode-decomposition-emd">
<h1>Empirical mode decomposition (EMD)<a class="headerlink" href="#empirical-mode-decomposition-emd" title="Link to this heading"></a></h1>
<p>Empirical Mode Decomposition (EMD) is a signal processing method used to decompose a signal into a set of intrinsic mode functions (IMFs), which are oscillatory components obtained adaptively from the data. The method iteratively identifies local extrema, constructs upper and lower envelopes using spline interpolation, and computes a local mean to extract IMFs. A significant drawback of EMD lies in the accuracy of defining the local mean and envelopes, particularly near the boundaries of the data, where end effects can lead to distortions. These boundary issues and the reliance on spline interpolation may result in inaccuracies in the extracted modes.</p>
<a class="reference internal image-reference" href="_images/classic_emd_1.png"><img alt="_images/classic_emd_1.png" src="_images/classic_emd_1.png" style="width: 695.2px; height: 244.0px;" />
</a>
<a class="reference internal image-reference" href="_images/classic_emd_2.png"><img alt="_images/classic_emd_2.png" src="_images/classic_emd_2.png" style="width: 695.2px; height: 244.0px;" />
</a>
<p>The 1D-EMD decomposition algorithm, adapted for hyperspectral image (HSI) analysis, incorporates several updates compared to the classical approach:
1. Precise calculation of the local mean using a moving average window instead of the arithmetic mean of the envelope maxima and minima of the signal.
2. Introduction of a rule for computing the local mean when the window extends beyond the range of spectral channels.
3. Flexibility to adapt the window size to scales smaller than the distance between adjacent zero-crossings in the current empirical mode (EM) or the initial window width.
4. Noise suppression in EMs by increasing the initial window size and applying it multiple times.</p>
<a class="reference internal image-reference" href="_images/swemd.png"><img alt="_images/swemd.png" src="_images/swemd.png" style="width: 695.2px; height: 244.0px;" />
</a>
<section id="module-hsip.swemd.swemd">
<span id="methods-for-decomposition-into-emd"></span><h2>Methods for decomposition into EMD<a class="headerlink" href="#module-hsip.swemd.swemd" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="hsip.swemd.swemd.SWEMD">
<span class="sig-prename descclassname"><span class="pre">hsip.swemd.swemd.</span></span><span class="sig-name descname"><span class="pre">SWEMD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_modes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hsip/swemd/swemd.html#SWEMD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hsip.swemd.swemd.SWEMD" title="Link to this definition"></a></dt>
<dd><p>Returns for a 1D signal its IMF and windows for each of them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – An array of dimension 3 (height * width * bands), dimension 2 (n_samples * bands), or just a single sample.</p></li>
<li><p><strong>number_of_modes</strong> (<em>int</em><em>, </em><em>default=4</em>) – The number of IMFs to calculate for the input signal.</p></li>
<li><p><strong>windows_size</strong> (<em>list</em><em> or </em><em>tuple</em><em> of </em><em>int</em><em>, </em><em>default=3</em>) – The size of windows for each mode, starting with the first. If the list type is passed, then each element will indicate the size of the window starting with the first IMF.
The list of passed sizes can be less than specified in <cite>number_of_modes</cite>, in which case subsequent sizes of sliding windows will be calculated automatically.
The list can be passed a value equal to -1, in which case the window size will also be calculated automatically.
If int is passed, this number will be the size of the sliding window only for the first IMF.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>IMFs</strong> (<em>list</em>) – Empirical modes for each sample.</p></li>
<li><p><strong>err_windows_size</strong> (<em>list</em>) – Window sizes for each level of empirical modes.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>EMD calculation: window lengths equal three for the 1st and 2nd modes, 5 for the 3rd mode, and automatic for the rest.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hsip.swemd.swemd</span> <span class="kn">import</span> <span class="n">SWEMD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># Example spectral data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IMFs</span><span class="p">,</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">SWEMD</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">number_of_modes</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">windows_size</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IMFs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">windows</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(8, 1000, 1000, 100), (8, 1000, 1000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="hsip.swemd.swemd.SWEMD_signal">
<span class="sig-prename descclassname"><span class="pre">hsip.swemd.swemd.</span></span><span class="sig-name descname"><span class="pre">SWEMD_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iSample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_modes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">windows_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[3]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hsip/swemd/swemd.html#SWEMD_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hsip.swemd.swemd.SWEMD_signal" title="Link to this definition"></a></dt>
<dd><p>Returns IMFs for each sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – One-dimensional signal.</p></li>
<li><p><strong>number_of_modes</strong> (<em>int</em><em>, </em><em>default=4</em>) – The number of IMFs to calculate for the input signal.</p></li>
<li><p><strong>windows_size</strong> (<em>list</em><em> or </em><em>tuple</em><em> of </em><em>int</em><em>, </em><em>default=3</em>) – The size of windows for each mode, starting with the first. If the list type is passed, then each element will indicate the size of the window starting with the first IMF.
The list of passed sizes can be less than specified in <cite>number_of_modes</cite>, in which case subsequent sizes of sliding windows will be calculated automatically.
The list can be passed a value equal to -1, in which case the window size will also be calculated automatically.
If int is passed, this number will be the size of the sliding window only for the first IMF.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>IMFs</strong> (<em>list</em>) – Empirical modes for each sample.</p></li>
<li><p><strong>err_windows_size</strong> (<em>list</em>) – Window sizes for each level of empirical modes.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>EMD calculation: window lengths equal three for the 1st and 2nd modes, 5 for the 3rd mode, and automatic for the rest.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">hsip.swemd.swemd</span> <span class="kn">import</span> <span class="n">SWEMD_signal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>  <span class="c1"># Example spectral data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IMFs</span><span class="p">,</span> <span class="n">windows</span> <span class="o">=</span> <span class="n">SWEMD</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">number_of_modes</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">windows_size</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">IMFs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">windows</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(100), (8)</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hsip.rgb.html" class="btn btn-neutral float-left" title="Color image synthesis" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Pukhkii Konstantin.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>